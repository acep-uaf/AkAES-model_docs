<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>aaem.components.annual_savings.annual_savings &mdash; Alaska Affordable Energy Model 0.17.2 documentation</title>
    
    <link rel="stylesheet" href="../../../../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../../',
        VERSION:     '0.17.2',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../../_static/doctools.js"></script>
    <link rel="top" title="Alaska Affordable Energy Model 0.17.2 documentation" href="../../../../index.html" />
    <link rel="up" title="aaem.components" href="../../components.html" />

   
  <link rel="stylesheet" href="../../../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

<script type="text/javascript"  >
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-6824535-25', 'auto');
  ga('send', 'pageview');

</script>

  </head>
  <body role="document">
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for aaem.components.annual_savings.annual_savings</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">annual_savings.py</span>
<span class="sd">ross spicer</span>
<span class="sd">created: 2015/09/16</span>

<span class="sd">    this file is the representation of what is being calculated at the bottom of</span>
<span class="sd">each of the spread sheet tabs.</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">os.path</span>
<span class="kn">from</span> <span class="nn">abc</span> <span class="k">import</span> <span class="n">ABCMeta</span><span class="p">,</span> <span class="n">abstractmethod</span>
<span class="kn">from</span> <span class="nn">pandas</span> <span class="k">import</span> <span class="n">DataFrame</span>


<div class="viewcode-block" id="AnnualSavings"><a class="viewcode-back" href="../../../../aaem.components.annual_savings.html#aaem.components.annual_savings.annual_savings.AnnualSavings">[docs]</a><span class="k">class</span> <span class="nc">AnnualSavings</span> <span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Abstract base class to use as base class for all model components</span>
<span class="sd">    that have the goal of generating an NPV benefit for the project</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">__metaclass__</span> <span class="o">=</span> <span class="n">ABCMeta</span>

<div class="viewcode-block" id="AnnualSavings.calc_annual_total_savings"><a class="viewcode-back" href="../../../../aaem.components.annual_savings.html#aaem.components.annual_savings.annual_savings.AnnualSavings.calc_annual_total_savings">[docs]</a>    <span class="k">def</span> <span class="nf">calc_annual_total_savings</span> <span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        calculate an array of annual savings values for the project</span>

<span class="sd">        pre:</span>
<span class="sd">            self.annual_electric_savings and self.annual_heating_savings</span>
<span class="sd">        need to be arrays of dollar values.</span>
<span class="sd">        post:</span>
<span class="sd">            annual_total_savings will be an array of dollar amounts.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1">#~ print self.annual_electric_savings, self.annual_heating_savings</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">annual_total_savings</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">annual_electric_savings</span> <span class="o">+</span> \
                              <span class="bp">self</span><span class="o">.</span><span class="n">annual_heating_savings</span></div>

<div class="viewcode-block" id="AnnualSavings.calc_annual_costs"><a class="viewcode-back" href="../../../../aaem.components.annual_savings.html#aaem.components.annual_savings.annual_savings.AnnualSavings.calc_annual_costs">[docs]</a>    <span class="k">def</span> <span class="nf">calc_annual_costs</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rate</span><span class="p">,</span> <span class="n">cost_scaler</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        calculate the cost of the project for each year.</span>

<span class="sd">        pre:</span>
<span class="sd">            rate should be an interest rate.</span>
<span class="sd">            self.project_life is the # of years project is active for</span>
<span class="sd">            self.capital_costs is the total cost of the project</span>
<span class="sd">        post:</span>
<span class="sd">            self.annual_costs will be a numpy array of dollar values</span>
<span class="sd">        indicating the cost of the project per year.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">rate</span> <span class="o">=</span> <span class="n">rate</span> <span class="o">/</span> <span class="mf">100.0</span>
        <span class="c1">#~ print self.component_name, cost_scaler</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">capital_costs</span> <span class="o">*=</span> <span class="n">cost_scaler</span>
        <span class="n">cost_per_year</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">pmt</span><span class="p">(</span><span class="n">rate</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">actual_project_life</span><span class="p">,</span>
                                    <span class="bp">self</span><span class="o">.</span><span class="n">capital_costs</span><span class="p">)</span>
        <span class="n">cpi</span><span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">forecast</span><span class="o">.</span><span class="n">cpi</span><span class="p">[:</span><span class="bp">self</span><span class="o">.</span><span class="n">actual_project_life</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">annual_costs</span> <span class="o">=</span> <span class="n">cost_per_year</span> <span class="o">*</span> <span class="n">cpi</span><span class="c1"># np.ones(self.actual_project_life)</span></div>


<div class="viewcode-block" id="AnnualSavings.calc_annual_net_benefit"><a class="viewcode-back" href="../../../../aaem.components.annual_savings.html#aaem.components.annual_savings.annual_savings.AnnualSavings.calc_annual_net_benefit">[docs]</a>    <span class="k">def</span> <span class="nf">calc_annual_net_benefit</span> <span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        calculate the yearly benefit of the project</span>
<span class="sd">        pre:</span>
<span class="sd">            annual_total_savings and annual_costs are arrays of the same length</span>
<span class="sd">        (project life) consisting of dollar values</span>
<span class="sd">        post:</span>
<span class="sd">            annual_net_benefit is an array of the annual monetary benefit over</span>
<span class="sd">        projects life time</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">annual_net_benefit</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">annual_total_savings</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">annual_costs</span></div>

<div class="viewcode-block" id="AnnualSavings.calc_npv"><a class="viewcode-back" href="../../../../aaem.components.annual_savings.html#aaem.components.annual_savings.annual_savings.AnnualSavings.calc_npv">[docs]</a>    <span class="k">def</span> <span class="nf">calc_npv</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rate</span><span class="p">,</span> <span class="n">current_year</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        clacualte the NPV net benfit</span>
<span class="sd">        pre:</span>
<span class="sd">            rate: should be the savings rate</span>
<span class="sd">            self.annual_net_benefit is  an array of the annual monetary benefit</span>
<span class="sd">        over projects life time</span>
<span class="sd">        post:</span>
<span class="sd">            self.net_npv, self.benefit_npv, slef.cost_npv is a dollar value</span>
<span class="sd">            self.benefit_cost_ratio is a ratio</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">rate</span> <span class="o">=</span> <span class="n">rate</span> <span class="o">/</span> <span class="mf">100.0</span>
        <span class="c1"># These need to be calculated for the actual project life</span>
        <span class="n">end</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">actual_project_life</span>


        <span class="c1"># number of arrays as zero ($ value) until project start</span>
        <span class="n">yts</span> <span class="o">=</span> <span class="p">[]</span><span class="c1">#np.zeros((self.start_year - current_year)+1)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">benefit_npv</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">npv</span><span class="p">(</span><span class="n">rate</span><span class="p">,</span>
                           <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">yts</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">annual_total_savings</span><span class="p">[:</span><span class="n">end</span><span class="p">]))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cost_npv</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">npv</span><span class="p">(</span><span class="n">rate</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">yts</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">annual_costs</span><span class="p">[:</span><span class="n">end</span><span class="p">]))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">benefit_cost_ratio</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">benefit_npv</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">cost_npv</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">net_npv</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">npv</span><span class="p">(</span><span class="n">rate</span><span class="p">,</span>
                       <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">yts</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">annual_net_benefit</span><span class="p">[:</span><span class="n">end</span><span class="p">]))</span></div>

<div class="viewcode-block" id="AnnualSavings.calc_cost_of_energy"><a class="viewcode-back" href="../../../../aaem.components.annual_savings.html#aaem.components.annual_savings.annual_savings.AnnualSavings.calc_cost_of_energy">[docs]</a>    <span class="k">def</span> <span class="nf">calc_cost_of_energy</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fuel_amount</span><span class="p">,</span> <span class="n">maintenance</span> <span class="o">=</span> <span class="mi">0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        calculates the cost of energy</span>
<span class="sd">        pre:</span>
<span class="sd">            fuel_amount is a the amount of fuel generated, used or saved</span>
<span class="sd">        units may vary (i.e. kWh, gal..) per year scaler, list, or np.array</span>
<span class="sd">            maintenance is the operation and maintenance cost per year as a</span>
<span class="sd">        scaler, list, or np.array</span>

<span class="sd">        post:</span>
<span class="sd">            returns a price in $/[units of fuel_amount]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">yts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">start_year</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">cd</span><span class="p">[</span><span class="s2">&quot;current year&quot;</span><span class="p">])</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">type</span><span class="p">(</span><span class="n">maintenance</span><span class="p">)</span> <span class="ow">in</span> <span class="p">[</span><span class="nb">list</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]:</span>
            <span class="n">maintenance</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">actual_project_life</span><span class="p">)</span> <span class="o">+</span>  <span class="n">maintenance</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">maintenance</span> <span class="o">=</span> <span class="n">maintenance</span><span class="p">[:</span><span class="bp">self</span><span class="o">.</span><span class="n">actual_project_life</span><span class="p">]</span>
        <span class="n">maintenance</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">maintenance</span><span class="p">)</span>

        <span class="n">maintenance_npv</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">npv</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">cd</span><span class="p">[</span><span class="s1">&#39;discount rate&#39;</span><span class="p">]</span><span class="o">/</span><span class="mf">100.0</span><span class="p">),</span>
                                    <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">yts</span><span class="p">,</span> <span class="n">maintenance</span><span class="p">))</span>


        <span class="k">if</span> <span class="ow">not</span> <span class="nb">type</span><span class="p">(</span><span class="n">fuel_amount</span><span class="p">)</span> <span class="ow">in</span> <span class="p">[</span><span class="nb">list</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]:</span>
            <span class="n">fuel_amount</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">actual_project_life</span><span class="p">)</span> <span class="o">+</span> <span class="n">fuel_amount</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">fuel_amount</span> <span class="o">=</span> <span class="n">fuel_amount</span><span class="p">[:</span><span class="bp">self</span><span class="o">.</span><span class="n">actual_project_life</span><span class="p">]</span>

        <span class="n">fuel_npv</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">npv</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">cd</span><span class="p">[</span><span class="s1">&#39;discount rate&#39;</span><span class="p">]</span><span class="o">/</span><span class="mf">100.0</span><span class="p">),</span>
                                    <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">yts</span><span class="p">,</span> <span class="n">fuel_amount</span><span class="p">))</span>


        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cost_npv</span> <span class="o">+</span> <span class="n">maintenance_npv</span><span class="p">)</span><span class="o">/</span> <span class="n">fuel_npv</span></div>

<div class="viewcode-block" id="AnnualSavings.calc_levelized_costs"><a class="viewcode-back" href="../../../../aaem.components.annual_savings.html#aaem.components.annual_savings.annual_savings.AnnualSavings.calc_levelized_costs">[docs]</a>    <span class="k">def</span> <span class="nf">calc_levelized_costs</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">maintenance_costs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        calculate the levelized costs</span>
<span class="sd">        pre:</span>
<span class="sd">            maintenance_costs is the operation and maintenance cost per year</span>
<span class="sd">            self.get_fuel_total_saved(), and self.get_total_energy_produced (),</span>
<span class="sd">        must exitst and return numbers representing fuel saved, anenergy</span>
<span class="sd">        produced or a dict with &#39;MMBtu&#39; and &#39;kWh&#39; as keys whose values are</span>
<span class="sd">        numbers</span>
<span class="sd">        post:</span>
<span class="sd">            self.break_even_cost is the break even cost in $/gal</span>
<span class="sd">            self.levelized_cost_of_energy is the LCOE in $/kWh for</span>
<span class="sd">        electricity projects, and $/MMBtu for heating projects</span>
<span class="sd">            for projectes with electricity efficciency and heating efficiency</span>
<span class="sd">        self.levelized_cost_of_energy is a dictonary wiht &#39;MMBtu&#39; and &#39;kWh&#39;</span>
<span class="sd">        as keys</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">fuel_saved</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_fuel_total_saved</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">break_even_cost</span> <span class="o">=</span> \
            <span class="bp">self</span><span class="o">.</span><span class="n">calc_cost_of_energy</span><span class="p">(</span><span class="n">fuel_saved</span><span class="p">,</span> <span class="n">maintenance_costs</span><span class="p">)</span>

        <span class="n">energy_produced</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_total_energy_produced</span> <span class="p">()</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">energy_produced</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">dict</span><span class="p">:</span>
            <span class="c1">#~ print energy_produced[&#39;MMBtu&#39;]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">levelized_cost_of_energy</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">levelized_cost_of_energy</span><span class="p">[</span><span class="s1">&#39;MMBtu&#39;</span><span class="p">]</span> <span class="o">=</span> \
                <span class="bp">self</span><span class="o">.</span><span class="n">calc_cost_of_energy</span><span class="p">(</span><span class="n">energy_produced</span><span class="p">[</span><span class="s1">&#39;MMBtu&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>
                                         <span class="n">maintenance_costs</span><span class="p">)</span><span class="o">*</span>\
                                            <span class="n">energy_produced</span><span class="p">[</span><span class="s1">&#39;MMBtu&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">levelized_cost_of_energy</span><span class="p">[</span><span class="s1">&#39;kWh&#39;</span><span class="p">]</span> <span class="o">=</span> \
                <span class="bp">self</span><span class="o">.</span><span class="n">calc_cost_of_energy</span><span class="p">(</span><span class="n">energy_produced</span><span class="p">[</span><span class="s1">&#39;kWh&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>
                                         <span class="n">maintenance_costs</span><span class="p">)</span><span class="o">*</span>\
                                            <span class="n">energy_produced</span><span class="p">[</span><span class="s1">&#39;kWh&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">levelized_cost_of_energy</span> <span class="o">=</span> \
                <span class="bp">self</span><span class="o">.</span><span class="n">calc_cost_of_energy</span><span class="p">(</span><span class="n">energy_produced</span><span class="p">,</span> <span class="n">maintenance_costs</span><span class="p">)</span></div>

<div class="viewcode-block" id="AnnualSavings.calc_internal_rate_of_return"><a class="viewcode-back" href="../../../../aaem.components.annual_savings.html#aaem.components.annual_savings.annual_savings.AnnualSavings.calc_internal_rate_of_return">[docs]</a>    <span class="k">def</span> <span class="nf">calc_internal_rate_of_return</span> <span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        calculate the interal rate of return</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">irr</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">l</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">capital_costs</span><span class="p">]</span> <span class="o">+</span>\
                <span class="bp">self</span><span class="o">.</span><span class="n">annual_total_savings</span><span class="p">[:</span><span class="bp">self</span><span class="o">.</span><span class="n">actual_project_life</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">irr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">irr</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>
        <span class="k">except</span> <span class="p">(</span><span class="ne">AttributeError</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">LinAlgError</span><span class="p">):</span>
            <span class="k">pass</span></div>

<div class="viewcode-block" id="AnnualSavings.set_project_life_details"><a class="viewcode-back" href="../../../../aaem.components.annual_savings.html#aaem.components.annual_savings.annual_savings.AnnualSavings.set_project_life_details">[docs]</a>    <span class="k">def</span> <span class="nf">set_project_life_details</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">start_year</span><span class="p">,</span><span class="n">project_life</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        set the details for the project life time(</span>
<span class="sd">        pre:</span>
<span class="sd">            start_year is an int represnting a year</span>
<span class="sd">            projct life: is the number(int &gt;0) of years (&lt;= fc_period)</span>
<span class="sd">            fc_period: &lt;int&gt; length of forecast period</span>
<span class="sd">        post:</span>
<span class="sd">            self.start_year, and self.project_life are the input values</span>
<span class="sd">        and self.end_year would be the year the project ends.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">start_year</span> <span class="o">=</span> <span class="n">start_year</span>

        <span class="c1">#~ # do caclulations for whole forecast period &amp; only save project life</span>
        <span class="c1">#~ self.project_life = fc_period</span>
        <span class="c1">#~ self.end_year = self.start_year + self.project_life</span>

        <span class="c1"># remember the actual lifetime</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actual_project_life</span> <span class="o">=</span> <span class="n">project_life</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">project_life</span> <span class="o">=</span> <span class="n">project_life</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actual_end_year</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_year</span> <span class="o">+</span> <span class="n">project_life</span> <span class="o">-</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">end_year</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_year</span> <span class="o">+</span> <span class="n">project_life</span> <span class="o">-</span> <span class="mi">1</span></div>

<div class="viewcode-block" id="AnnualSavings.get_diesel_prices"><a class="viewcode-back" href="../../../../aaem.components.annual_savings.html#aaem.components.annual_savings.annual_savings.AnnualSavings.get_diesel_prices">[docs]</a>    <span class="k">def</span> <span class="nf">get_diesel_prices</span> <span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        get the diesel prices</span>

<span class="sd">        pre:</span>
<span class="sd">            community name should be in the community data.</span>
<span class="sd">        post:</span>
<span class="sd">            self.diesel prices has prices for the project life</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1">#~ prices = self.cd[&quot;diesel prices&quot;]</span>
        <span class="c1">#~ self.diesel_prices = prices.get_projected_prices(self.start_year,</span>
                                                         <span class="c1">#~ self.end_year)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cd</span><span class="p">[</span><span class="s2">&quot;diesel prices&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> \
            <span class="bp">self</span><span class="o">.</span><span class="n">cd</span><span class="p">[</span><span class="s2">&quot;diesel prices&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cd</span><span class="p">[</span><span class="s2">&quot;diesel prices&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cd</span><span class="p">[</span><span class="s2">&quot;diesel prices&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">diesel_prices</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cd</span><span class="p">[</span><span class="s2">&quot;diesel prices&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">ix</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">start_year</span><span class="p">:]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">diesel_prices</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;prices&#39;</span><span class="p">]</span>
        <span class="n">start</span><span class="p">,</span> <span class="n">end</span>  <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_year</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">end_year</span>


        <span class="n">existing_len</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">diesel_prices</span><span class="o">.</span><span class="n">ix</span><span class="p">[</span><span class="n">start</span><span class="p">:</span><span class="n">end</span><span class="p">])</span>
        <span class="n">extend_by</span> <span class="o">=</span> <span class="p">(</span><span class="n">end</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">start</span> <span class="o">-</span> <span class="n">existing_len</span>
        <span class="k">if</span> <span class="n">extend_by</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">extend</span> <span class="o">=</span> <span class="n">DataFrame</span><span class="p">(</span>
                <span class="n">index</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">diesel_prices</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span>
                     <span class="bp">self</span><span class="o">.</span><span class="n">diesel_prices</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">extend_by</span> <span class="o">+</span><span class="mi">1</span>
                <span class="p">),</span>
                <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;prices&#39;</span><span class="p">])</span>
            <span class="n">extend</span><span class="p">[</span><span class="s1">&#39;prices&#39;</span><span class="p">]</span> <span class="o">=</span>  <span class="bp">self</span><span class="o">.</span><span class="n">diesel_prices</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;prices&#39;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">diesel_prices</span> <span class="o">=</span> \
                <span class="n">DataFrame</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">diesel_prices</span><span class="o">.</span><span class="n">ix</span><span class="p">[</span><span class="n">start</span><span class="p">:</span><span class="n">end</span><span class="p">][</span><span class="s1">&#39;prices&#39;</span><span class="p">])</span><span class="o">.</span>\
                <span class="n">append</span><span class="p">(</span><span class="n">extend</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1">#  -1 to ensure same behavour</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">diesel_prices</span> <span class="o">=</span> \
                <span class="n">DataFrame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">diesel_prices</span><span class="p">[</span><span class="s1">&#39;prices&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">ix</span><span class="p">[</span><span class="n">start</span><span class="p">:</span><span class="n">end</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">diesel_prices</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">diesel_prices</span><span class="p">[</span><span class="s1">&#39;prices&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span></div>


<div class="viewcode-block" id="AnnualSavings.get_electricity_prices"><a class="viewcode-back" href="../../../../aaem.components.annual_savings.html#aaem.components.annual_savings.annual_savings.AnnualSavings.get_electricity_prices">[docs]</a>    <span class="k">def</span> <span class="nf">get_electricity_prices</span> <span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cd</span><span class="p">[</span><span class="s2">&quot;electric prices&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> \
            <span class="bp">self</span><span class="o">.</span><span class="n">cd</span><span class="p">[</span><span class="s2">&quot;electric prices&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cd</span><span class="p">[</span><span class="s2">&quot;electric prices&quot;</span><span class="p">]</span> <span class="o">=</span> \
            <span class="bp">self</span><span class="o">.</span><span class="n">cd</span><span class="p">[</span><span class="s2">&quot;electric prices&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
        <span class="n">prices</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cd</span><span class="p">[</span><span class="s2">&quot;electric prices&quot;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">electricity_prices</span> <span class="o">=</span> <span class="n">prices</span><span class="o">.</span><span class="n">ix</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">start_year</span><span class="p">:]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">cd</span><span class="p">[</span><span class="s2">&quot;electric prices&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cd</span><span class="p">[</span><span class="s2">&quot;electric prices&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cd</span><span class="p">[</span><span class="s2">&quot;electric prices&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cd</span><span class="p">[</span><span class="s2">&quot;electric prices&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">electricity_prices</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cd</span><span class="p">[</span><span class="s2">&quot;electric prices&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">ix</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">start_year</span><span class="p">:]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">electricity_prices</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;prices&#39;</span><span class="p">]</span>
        <span class="n">start</span><span class="p">,</span> <span class="n">end</span>  <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_year</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">end_year</span>


        <span class="n">existing_len</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">electricity_prices</span><span class="o">.</span><span class="n">ix</span><span class="p">[</span><span class="n">start</span><span class="p">:</span><span class="n">end</span><span class="p">])</span>
        <span class="n">extend_by</span> <span class="o">=</span> <span class="p">(</span><span class="n">end</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">start</span> <span class="o">-</span> <span class="n">existing_len</span>
        <span class="k">if</span> <span class="n">extend_by</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">extend</span> <span class="o">=</span> <span class="n">DataFrame</span><span class="p">(</span>
                <span class="n">index</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">electricity_prices</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span><span class="mi">1</span> <span class="p">,</span>
                     <span class="bp">self</span><span class="o">.</span><span class="n">electricity_prices</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="o">+</span><span class="n">extend_by</span>
                <span class="p">),</span>
                <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;prices&#39;</span><span class="p">])</span>
            <span class="n">extend</span><span class="p">[</span><span class="s1">&#39;prices&#39;</span><span class="p">]</span> <span class="o">=</span>  <span class="bp">self</span><span class="o">.</span><span class="n">electricity_prices</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;prices&#39;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">electricity_prices</span> <span class="o">=</span> \
                <span class="n">DataFrame</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">electricity_prices</span><span class="o">.</span><span class="n">ix</span><span class="p">[</span><span class="n">start</span><span class="p">:</span><span class="n">end</span><span class="p">][</span><span class="s1">&#39;prices&#39;</span><span class="p">])</span><span class="o">.</span>\
                <span class="n">append</span><span class="p">(</span><span class="n">extend</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1">#  -1 to ensure same behavour</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">electricity_prices</span> <span class="o">=</span> \
                <span class="n">DataFrame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">electricity_prices</span><span class="p">[</span><span class="s1">&#39;prices&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">ix</span><span class="p">[</span><span class="n">start</span><span class="p">:</span><span class="n">end</span><span class="p">])</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">electricity_prices</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">electricity_prices</span><span class="p">[</span><span class="s1">&#39;prices&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span></div>


<div class="viewcode-block" id="AnnualSavings.save_additional_output"><a class="viewcode-back" href="../../../../aaem.components.annual_savings.html#aaem.components.annual_savings.annual_savings.AnnualSavings.save_additional_output">[docs]</a>    <span class="k">def</span> <span class="nf">save_additional_output</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">directory</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">pass</span></div>

    <span class="nd">@abstractmethod</span>
<div class="viewcode-block" id="AnnualSavings.calc_capital_costs"><a class="viewcode-back" href="../../../../aaem.components.annual_savings.html#aaem.components.annual_savings.annual_savings.AnnualSavings.calc_capital_costs">[docs]</a>    <span class="k">def</span> <span class="nf">calc_capital_costs</span> <span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        abstract function</span>
<span class="sd">        should be implemented by child class to calculate self.capital_costs</span>
<span class="sd">        (the cost of the project) a dollar value</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">,</span> <span class="s2">&quot;should be implemented by child class to&quot;</span> <span class="o">+</span>\
        <span class="s2">&quot; calculate self.capital_costs(the cost of the project) a dollar value&quot;</span></div>


    <span class="nd">@abstractmethod</span>
<div class="viewcode-block" id="AnnualSavings.calc_annual_electric_savings"><a class="viewcode-back" href="../../../../aaem.components.annual_savings.html#aaem.components.annual_savings.annual_savings.AnnualSavings.calc_annual_electric_savings">[docs]</a>    <span class="k">def</span> <span class="nf">calc_annual_electric_savings</span> <span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        abstract function</span>
<span class="sd">        should be implemented by child class to create</span>
<span class="sd">        self.annual_electric_savings as an np.array, length self.project_life,</span>
<span class="sd">        of dollar values(numbers)&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">,</span> <span class="s2">&quot;should be implemented by child class to&quot;</span> <span class="o">+</span>\
        <span class="s2">&quot; create self.annual_electric_savings as an np.array, length&quot;</span> <span class="o">+</span>\
        <span class="s2">&quot; self.project_life, of dollar values(numbers)&quot;</span></div>

    <span class="nd">@abstractmethod</span>
<div class="viewcode-block" id="AnnualSavings.calc_annual_heating_savings"><a class="viewcode-back" href="../../../../aaem.components.annual_savings.html#aaem.components.annual_savings.annual_savings.AnnualSavings.calc_annual_heating_savings">[docs]</a>    <span class="k">def</span> <span class="nf">calc_annual_heating_savings</span> <span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        abstract function</span>
<span class="sd">        should be implemented by child class to create</span>
<span class="sd">        self.annual_heating_savings as an np.array, length self.project_life,</span>
<span class="sd">        of dollar values(numbers)&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">,</span> <span class="s2">&quot;should be implemented by child class to&quot;</span> <span class="o">+</span>\
        <span class="s2">&quot; create self.annual_heating_savings as an np.array, length&quot;</span> <span class="o">+</span>\
        <span class="s2">&quot; self.project_life, of dollar values(numbers)&quot;</span></div>

    <span class="nd">@abstractmethod</span>
<div class="viewcode-block" id="AnnualSavings.run"><a class="viewcode-back" href="../../../../aaem.components.annual_savings.html#aaem.components.annual_savings.annual_savings.AnnualSavings.run">[docs]</a>    <span class="k">def</span> <span class="nf">run</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">scalers</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;capital costs&#39;</span><span class="p">:</span><span class="mf">1.0</span><span class="p">}):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        abstract function</span>
<span class="sd">        should be implemented by child class to run component</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">,</span> <span class="s2">&quot;should be implemented by child class to&quot;</span> <span class="o">+</span>\
        <span class="s2">&quot; run the component&quot;</span></div>

    <span class="c1">## helper</span>
<div class="viewcode-block" id="AnnualSavings.get_nan_range"><a class="viewcode-back" href="../../../../aaem.components.annual_savings.html#aaem.components.annual_savings.annual_savings.AnnualSavings.get_nan_range">[docs]</a>    <span class="k">def</span> <span class="nf">get_nan_range</span> <span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            gets an array of nan&#39;s for the project life time, the &quot;get&quot;</span>
<span class="sd">        functions defined here should return a array of nan&#39;s indicating that</span>
<span class="sd">        the value is not applicable to the component. If a &quot;get&quot; should do</span>
<span class="sd">        something else overload it in the component</span>
<span class="sd">        pre:</span>
<span class="sd">            self.lifetime &gt; 0</span>
<span class="sd">        post:</span>
<span class="sd">            returns array of nan&#39;s length self.lifetime</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">project_life</span><span class="p">)</span><span class="o">/</span><span class="mi">0</span></div>

    <span class="c1">## Heating</span>
<div class="viewcode-block" id="AnnualSavings.get_base_HF_use"><a class="viewcode-back" href="../../../../aaem.components.annual_savings.html#aaem.components.annual_savings.annual_savings.AnnualSavings.get_base_HF_use">[docs]</a>    <span class="k">def</span> <span class="nf">get_base_HF_use</span> <span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="c1"># ex: eff(res) G89-V89</span>
        <span class="sd">&quot;&quot;&quot; returns HF use array (baseline) &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">baseline_HF_consumption</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_nan_range</span><span class="p">()</span></div>

<div class="viewcode-block" id="AnnualSavings.get_proposed_HF_use"><a class="viewcode-back" href="../../../../aaem.components.annual_savings.html#aaem.components.annual_savings.annual_savings.AnnualSavings.get_proposed_HF_use">[docs]</a>    <span class="k">def</span> <span class="nf">get_proposed_HF_use</span> <span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="c1"># ex: eff(res) G81-V81</span>
        <span class="sd">&quot;&quot;&quot; returns HF use array (proposed) &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">proposed_HF_consumption</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_nan_range</span><span class="p">()</span></div>

<div class="viewcode-block" id="AnnualSavings.get_base_HF_cost"><a class="viewcode-back" href="../../../../aaem.components.annual_savings.html#aaem.components.annual_savings.annual_savings.AnnualSavings.get_base_HF_cost">[docs]</a>    <span class="k">def</span> <span class="nf">get_base_HF_cost</span> <span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="c1"># ex: eff(res) G93-V93</span>
        <span class="sd">&quot;&quot;&quot; returns HF cost array (baseline) &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">baseline_HF_cost</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_nan_range</span><span class="p">()</span></div>

<div class="viewcode-block" id="AnnualSavings.get_proposed_HF_cost"><a class="viewcode-back" href="../../../../aaem.components.annual_savings.html#aaem.components.annual_savings.annual_savings.AnnualSavings.get_proposed_HF_cost">[docs]</a>    <span class="k">def</span> <span class="nf">get_proposed_HF_cost</span> <span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="c1"># ex: eff(res) G86-V86</span>
        <span class="sd">&quot;&quot;&quot; returns HF cost array (proposed) &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">proposed_HF_cost</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_nan_range</span><span class="p">()</span></div>

<div class="viewcode-block" id="AnnualSavings.get_fuel_price"><a class="viewcode-back" href="../../../../aaem.components.annual_savings.html#aaem.components.annual_savings.annual_savings.AnnualSavings.get_fuel_price">[docs]</a>    <span class="k">def</span> <span class="nf">get_fuel_price</span> <span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="c1"># ex: eff(res) G84-V84 or G90-V90</span>
        <span class="sd">&quot;&quot;&quot; get the diesel fuel price used&quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1">### TODO:CHANGE THIS TOO??</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">diesel_prices</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_nan_range</span><span class="p">()</span></div>


    <span class="c1">## Electric</span>
<div class="viewcode-block" id="AnnualSavings.get_base_kWh_use"><a class="viewcode-back" href="../../../../aaem.components.annual_savings.html#aaem.components.annual_savings.annual_savings.AnnualSavings.get_base_kWh_use">[docs]</a>    <span class="k">def</span> <span class="nf">get_base_kWh_use</span> <span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="c1"># ex: eff(res) G89-V89</span>
        <span class="sd">&quot;&quot;&quot; returns kWh use array (baseline) &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">baseline_kWh_consumption</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_nan_range</span><span class="p">()</span></div>

<div class="viewcode-block" id="AnnualSavings.get_proposed_kWh_use"><a class="viewcode-back" href="../../../../aaem.components.annual_savings.html#aaem.components.annual_savings.annual_savings.AnnualSavings.get_proposed_kWh_use">[docs]</a>    <span class="k">def</span> <span class="nf">get_proposed_kWh_use</span> <span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="c1"># ex: eff(res) G73-V73</span>
        <span class="sd">&quot;&quot;&quot; returns kWh use array (proposed) &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">proposed_kWh_consumption</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_nan_range</span><span class="p">()</span></div>

<div class="viewcode-block" id="AnnualSavings.get_base_kWh_cost"><a class="viewcode-back" href="../../../../aaem.components.annual_savings.html#aaem.components.annual_savings.annual_savings.AnnualSavings.get_base_kWh_cost">[docs]</a>    <span class="k">def</span> <span class="nf">get_base_kWh_cost</span> <span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="c1"># ex: eff(res) G75-V75</span>
        <span class="sd">&quot;&quot;&quot; returns kWh cost array (baseline) &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">baseline_kWh_cost</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_nan_range</span><span class="p">()</span></div>

<div class="viewcode-block" id="AnnualSavings.get_proposed_kWh_cost"><a class="viewcode-back" href="../../../../aaem.components.annual_savings.html#aaem.components.annual_savings.annual_savings.AnnualSavings.get_proposed_kWh_cost">[docs]</a>    <span class="k">def</span> <span class="nf">get_proposed_kWh_cost</span> <span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="c1"># ex: eff(res) G70-V70</span>
        <span class="sd">&quot;&quot;&quot; returns kWh cost array (proposed) &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">proposed_kWh_cost</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_nan_range</span><span class="p">()</span></div>

    <span class="c1">## annual savings</span>
<div class="viewcode-block" id="AnnualSavings.get_electric_savings_costs"><a class="viewcode-back" href="../../../../aaem.components.annual_savings.html#aaem.components.annual_savings.annual_savings.AnnualSavings.get_electric_savings_costs">[docs]</a>    <span class="k">def</span> <span class="nf">get_electric_savings_costs</span> <span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="c1"># ex: eff(res) G57-V57 or G75-V75</span>
        <span class="sd">&quot;&quot;&quot; returns kWh savings array (base - proposed) &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">annual_electric_savings</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_nan_range</span><span class="p">()</span></div>

<div class="viewcode-block" id="AnnualSavings.get_heating_savings_costs"><a class="viewcode-back" href="../../../../aaem.components.annual_savings.html#aaem.components.annual_savings.annual_savings.AnnualSavings.get_heating_savings_costs">[docs]</a>    <span class="k">def</span> <span class="nf">get_heating_savings_costs</span> <span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="c1"># ex: eff(res) G58-V58 or G94-V94</span>
        <span class="sd">&quot;&quot;&quot; returns HF savings array (base - proposed) &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">annual_heating_savings</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_nan_range</span><span class="p">()</span></div>

<div class="viewcode-block" id="AnnualSavings.get_total_savings_costs"><a class="viewcode-back" href="../../../../aaem.components.annual_savings.html#aaem.components.annual_savings.annual_savings.AnnualSavings.get_total_savings_costs">[docs]</a>    <span class="k">def</span> <span class="nf">get_total_savings_costs</span> <span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="c1"># ex: eff(res) G59-V59</span>
        <span class="sd">&quot;&quot;&quot; returns total savings array &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">annual_total_savings</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_nan_range</span><span class="p">()</span></div>

<div class="viewcode-block" id="AnnualSavings.get_capital_costs"><a class="viewcode-back" href="../../../../aaem.components.annual_savings.html#aaem.components.annual_savings.annual_savings.AnnualSavings.get_capital_costs">[docs]</a>    <span class="k">def</span> <span class="nf">get_capital_costs</span> <span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="c1"># ex: eff(res) G55-V55</span>
        <span class="sd">&quot;&quot;&quot; return capital costs array &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">annual_costs</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_nan_range</span><span class="p">()</span></div>

<div class="viewcode-block" id="AnnualSavings.get_net_benefit"><a class="viewcode-back" href="../../../../aaem.components.annual_savings.html#aaem.components.annual_savings.annual_savings.AnnualSavings.get_net_benefit">[docs]</a>    <span class="k">def</span> <span class="nf">get_net_benefit</span> <span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="c1"># ex: eff(res) G62-V62</span>
        <span class="sd">&quot;&quot;&quot; return net benefit array &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">annual_net_benefit</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_nan_range</span><span class="p">()</span></div>

    <span class="c1">## NPVs</span>
<div class="viewcode-block" id="AnnualSavings.get_NPV_benefits"><a class="viewcode-back" href="../../../../aaem.components.annual_savings.html#aaem.components.annual_savings.annual_savings.AnnualSavings.get_NPV_benefits">[docs]</a>    <span class="k">def</span> <span class="nf">get_NPV_benefits</span> <span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="c1"># ex: eff(res) C13</span>
        <span class="sd">&quot;&quot;&quot; return NPV benefits (float) &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">benefit_npv</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;N/A&quot;</span></div>

<div class="viewcode-block" id="AnnualSavings.get_NPV_costs"><a class="viewcode-back" href="../../../../aaem.components.annual_savings.html#aaem.components.annual_savings.annual_savings.AnnualSavings.get_NPV_costs">[docs]</a>    <span class="k">def</span> <span class="nf">get_NPV_costs</span> <span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="c1"># ex: eff(res) C14</span>
        <span class="sd">&quot;&quot;&quot; return NPV costs (float) &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">cost_npv</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;N/A&quot;</span></div>

<div class="viewcode-block" id="AnnualSavings.get_BC_ratio"><a class="viewcode-back" href="../../../../aaem.components.annual_savings.html#aaem.components.annual_savings.annual_savings.AnnualSavings.get_BC_ratio">[docs]</a>    <span class="k">def</span> <span class="nf">get_BC_ratio</span> <span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="c1"># ex: eff(res) C15</span>
        <span class="sd">&quot;&quot;&quot; return NPV benefit/cost ratio (float) &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">benefit_cost_ratio</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;N/A&quot;</span></div>

<div class="viewcode-block" id="AnnualSavings.get_NPV_net_benefit"><a class="viewcode-back" href="../../../../aaem.components.annual_savings.html#aaem.components.annual_savings.annual_savings.AnnualSavings.get_NPV_net_benefit">[docs]</a>    <span class="k">def</span> <span class="nf">get_NPV_net_benefit</span> <span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="c1"># ex: eff(res) C16</span>
        <span class="sd">&quot;&quot;&quot; return NPV net benefit (float) &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">net_npv</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;N/A&quot;</span></div>

    <span class="c1">## save functions</span>
<div class="viewcode-block" id="AnnualSavings.save_csv_outputs"><a class="viewcode-back" href="../../../../aaem.components.annual_savings.html#aaem.components.annual_savings.annual_savings.AnnualSavings.save_csv_outputs">[docs]</a>    <span class="k">def</span> <span class="nf">save_csv_outputs</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">directory</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        save all csv outputs</span>
<span class="sd">        pre:</span>
<span class="sd">            directory should exist and be an absolute path</span>
<span class="sd">        post:</span>
<span class="sd">            electric,heating, and finical csv files are saved</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">save_component_csv</span><span class="p">(</span><span class="n">directory</span><span class="p">)</span></div>
        <span class="c1">#~ self.save_electric_csv (directory)</span>
        <span class="c1">#~ self.save_heating_csv (directory)</span>
        <span class="c1">#~ if self.cd[&quot;model financial&quot;]:</span>
            <span class="c1">#~ self.save_financial_csv (directory)</span>

<div class="viewcode-block" id="AnnualSavings.save_component_csv"><a class="viewcode-back" href="../../../../aaem.components.annual_savings.html#aaem.components.annual_savings.annual_savings.AnnualSavings.save_component_csv">[docs]</a>    <span class="k">def</span> <span class="nf">save_component_csv</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">directory</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        save the output from the component.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">was_run</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="n">years</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">project_life</span><span class="p">))</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_year</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">DataFrame</span><span class="p">({</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">component_name</span> <span class="o">+</span> \
                    <span class="s2">&quot;: Heating Fuel Consumption Baseline (gallons/year)&quot;</span><span class="p">:</span>
                                            <span class="bp">self</span><span class="o">.</span><span class="n">get_base_HF_use</span><span class="p">(),</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">component_name</span> <span class="o">+</span> \
                    <span class="s2">&quot;: Heating Fuel Consumption Proposed (gallons/year)&quot;</span><span class="p">:</span>
                                            <span class="bp">self</span><span class="o">.</span><span class="n">get_proposed_HF_use</span><span class="p">(),</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">component_name</span> <span class="o">+</span> \
                    <span class="s2">&quot;: Heating Fuel Consumption Savings (gallons/year)&quot;</span><span class="p">:</span>
                                            <span class="bp">self</span><span class="o">.</span><span class="n">get_base_HF_use</span><span class="p">()</span> <span class="o">-</span>\
                                            <span class="bp">self</span><span class="o">.</span><span class="n">get_proposed_HF_use</span><span class="p">(),</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">component_name</span> <span class="o">+</span> \
                    <span class="s2">&quot;: Heating Fuel Cost Baseline ($/year)&quot;</span><span class="p">:</span>
                                            <span class="bp">self</span><span class="o">.</span><span class="n">get_base_HF_cost</span><span class="p">(),</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">component_name</span> <span class="o">+</span> \
                    <span class="s2">&quot;: Heating Fuel Cost Proposed ($/year)&quot;</span><span class="p">:</span>
                                            <span class="bp">self</span><span class="o">.</span><span class="n">get_proposed_HF_cost</span><span class="p">(),</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">component_name</span> <span class="o">+</span> \
                    <span class="s2">&quot;: Heating Fuel Cost Savings ($/year)&quot;</span><span class="p">:</span>
                                            <span class="bp">self</span><span class="o">.</span><span class="n">get_heating_savings_costs</span><span class="p">(),</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">component_name</span> <span class="o">+</span> \
                    <span class="s2">&quot;: Electricity Consumption Baseline (kWh/year)&quot;</span><span class="p">:</span>
                                            <span class="bp">self</span><span class="o">.</span><span class="n">get_base_kWh_use</span><span class="p">(),</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">component_name</span> <span class="o">+</span> \
                    <span class="s2">&quot;: Electricity Consumption Proposed (kWh/year)&quot;</span><span class="p">:</span>
                                            <span class="bp">self</span><span class="o">.</span><span class="n">get_proposed_kWh_use</span><span class="p">(),</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">component_name</span> <span class="o">+</span> \
                    <span class="s2">&quot;: Electricity Consumption Savings (kWh/year)&quot;</span><span class="p">:</span>
                                            <span class="bp">self</span><span class="o">.</span><span class="n">get_base_kWh_use</span><span class="p">()</span> <span class="o">-</span>\
                                            <span class="bp">self</span><span class="o">.</span><span class="n">get_proposed_kWh_use</span><span class="p">(),</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">component_name</span> <span class="o">+</span> \
                    <span class="s2">&quot;: Electricity Cost Basline ($/year)&quot;</span><span class="p">:</span>
                                            <span class="bp">self</span><span class="o">.</span><span class="n">get_base_kWh_cost</span><span class="p">(),</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">component_name</span> <span class="o">+</span> \
                    <span class="s2">&quot;: Electricity Cost Proposed ($/year)&quot;</span><span class="p">:</span>
                                            <span class="bp">self</span><span class="o">.</span><span class="n">get_proposed_kWh_cost</span><span class="p">(),</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">component_name</span> <span class="o">+</span> \
                    <span class="s2">&quot;: Electricity Cost Savings ($/year)&quot;</span><span class="p">:</span>
                                            <span class="bp">self</span><span class="o">.</span><span class="n">get_electric_savings_costs</span><span class="p">(),</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">component_name</span> <span class="o">+</span> \
                    <span class="s2">&quot;: Project Capital Cost ($/year)&quot;</span><span class="p">:</span>
                                            <span class="bp">self</span><span class="o">.</span><span class="n">get_capital_costs</span><span class="p">(),</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">component_name</span> <span class="o">+</span> \
                    <span class="s2">&quot;: Total Cost Savings ($/year)&quot;</span><span class="p">:</span>
                                            <span class="bp">self</span><span class="o">.</span><span class="n">get_total_savings_costs</span><span class="p">(),</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">component_name</span> <span class="o">+</span> \
                    <span class="s2">&quot;: Net Benefit ($/year)&quot;</span><span class="p">:</span>
                                            <span class="bp">self</span><span class="o">.</span><span class="n">get_net_benefit</span><span class="p">(),</span>
                       <span class="p">},</span> <span class="n">years</span><span class="p">)</span>

        <span class="n">df</span><span class="p">[</span><span class="s2">&quot;Community&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cd</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span>

        <span class="n">ol</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Community&quot;</span><span class="p">,</span>
              <span class="bp">self</span><span class="o">.</span><span class="n">component_name</span> <span class="o">+</span> \
                        <span class="s2">&quot;: Heating Fuel Consumption Baseline (gallons/year)&quot;</span><span class="p">,</span>
              <span class="bp">self</span><span class="o">.</span><span class="n">component_name</span> <span class="o">+</span> \
                        <span class="s2">&quot;: Heating Fuel Consumption Proposed (gallons/year)&quot;</span><span class="p">,</span>
              <span class="bp">self</span><span class="o">.</span><span class="n">component_name</span> <span class="o">+</span> \
                        <span class="s2">&quot;: Heating Fuel Consumption Savings (gallons/year)&quot;</span><span class="p">,</span>
              <span class="bp">self</span><span class="o">.</span><span class="n">component_name</span> <span class="o">+</span> <span class="s2">&quot;: Heating Fuel Cost Baseline ($/year)&quot;</span><span class="p">,</span>
              <span class="bp">self</span><span class="o">.</span><span class="n">component_name</span> <span class="o">+</span> <span class="s2">&quot;: Heating Fuel Cost Proposed ($/year)&quot;</span><span class="p">,</span>
              <span class="bp">self</span><span class="o">.</span><span class="n">component_name</span> <span class="o">+</span> <span class="s2">&quot;: Heating Fuel Cost Savings ($/year)&quot;</span><span class="p">,</span>
              <span class="bp">self</span><span class="o">.</span><span class="n">component_name</span> <span class="o">+</span> \
                        <span class="s2">&quot;: Electricity Consumption Baseline (kWh/year)&quot;</span><span class="p">,</span>
              <span class="bp">self</span><span class="o">.</span><span class="n">component_name</span> <span class="o">+</span> \
                        <span class="s2">&quot;: Electricity Consumption Proposed (kWh/year)&quot;</span><span class="p">,</span>
              <span class="bp">self</span><span class="o">.</span><span class="n">component_name</span> <span class="o">+</span> \
                        <span class="s2">&quot;: Electricity Consumption Savings (kWh/year)&quot;</span><span class="p">,</span>
              <span class="bp">self</span><span class="o">.</span><span class="n">component_name</span> <span class="o">+</span> <span class="s2">&quot;: Electricity Cost Basline ($/year)&quot;</span><span class="p">,</span>
              <span class="bp">self</span><span class="o">.</span><span class="n">component_name</span> <span class="o">+</span> <span class="s2">&quot;: Electricity Cost Proposed ($/year)&quot;</span><span class="p">,</span>
              <span class="bp">self</span><span class="o">.</span><span class="n">component_name</span> <span class="o">+</span> <span class="s2">&quot;: Electricity Cost Savings ($/year)&quot;</span><span class="p">,</span>
              <span class="bp">self</span><span class="o">.</span><span class="n">component_name</span> <span class="o">+</span> <span class="s2">&quot;: Project Capital Cost ($/year)&quot;</span><span class="p">,</span>
              <span class="bp">self</span><span class="o">.</span><span class="n">component_name</span> <span class="o">+</span> <span class="s2">&quot;: Total Cost Savings ($/year)&quot;</span><span class="p">,</span>
              <span class="bp">self</span><span class="o">.</span><span class="n">component_name</span> <span class="o">+</span> <span class="s2">&quot;: Net Benefit ($/year)&quot;</span><span class="p">]</span>
        <span class="n">fname</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">directory</span><span class="p">,</span>
                               <span class="bp">self</span><span class="o">.</span><span class="n">cd</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span>\
                               <span class="bp">self</span><span class="o">.</span><span class="n">component_name</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="s1">&#39;_&#39;</span><span class="p">)</span><span class="o">.</span>\
                               <span class="n">replace</span><span class="p">(</span><span class="s1">&#39;&amp;&#39;</span><span class="p">,</span><span class="s1">&#39;and&#39;</span><span class="p">)</span> <span class="o">+</span>\
                               <span class="s2">&quot;_output.csv&quot;</span><span class="p">)</span>
        <span class="n">fname</span> <span class="o">=</span> <span class="n">fname</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="s2">&quot;_&quot;</span><span class="p">)</span>

        <span class="c1"># save to end of project(actual lifetime)</span>
        <span class="n">df</span><span class="p">[</span><span class="n">ol</span><span class="p">]</span><span class="o">.</span><span class="n">ix</span><span class="p">[:</span><span class="bp">self</span><span class="o">.</span><span class="n">actual_end_year</span><span class="p">]</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="n">index_label</span><span class="o">=</span><span class="s2">&quot;Year&quot;</span><span class="p">)</span></div></div>
</pre></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../../../index.html">Documentation overview</a><ul>
  <li><a href="../../../index.html">Module code</a><ul>
  <li><a href="../../components.html">aaem.components</a><ul>
  </ul></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../../../../search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2017, AEA, GINA.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.4.5</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.9</a>
      
    </div>

    

    
  </body>
</html>